<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>the one</title>
  <style media="screen">
    canvas {
      border: 1px black solid
    }
  </style>
</head>

<body>
  <canvas id="my-canvas" width="400" height="300"></canvas>
  
<script>
var log = console.log.bind(console)

var imageFromPath = function(path) {
  var img = new Image()
  img.src = path
  return img
}

var Paddle = function() {
  var image = imageFromPath('racket.png')
  var o = {
    image: image,
    x: 100,
    y: 200,
    speed: 5,
  }
  o.moveLeft = function() {
    this.x -= this.speed
  }
  o.moveRight = function() {
    this.x += this.speed
  }
  return o
}

var Game = function() {
  var g = {
    actions: {},
    keydowns: {},
  }
  var canvas = document.querySelector('#my-canvas')
  var context = canvas.getContext('2d')
  g.canvas = canvas
  g.context = context
  // events
  /*window.addEventListener('keydown', function(event) {
    g.keydowns[event.key] = true
  })
  window.addEventListener('keyup', function(event) {
    g.keydowns[event.key] = false
  })
  // 
  g.registerAction = function(key, callback) {
    g.actions[key] = callback
  }
  */
  // timer
  setInterval(function() {
    // events
   /* var actions = Object.keys(g.actions)
    for (var i = 0; i < actions.length; i++) {
      var key = action[i]
      if (g.keydowns[key]) {
        g.actions[key]
      }
    }*/
    // update
    g.update()
    // clear
    context.clearRect(0, 0, canvas.width, canvas.height)
    // draw
    g.draw()
  }, 1000/30)

  return g
}

var __main = function() {
  var game = Game()

  var paddle = Paddle()

  var leftDown = false
  var rightDown = false
  //events
  window.addEventListener('keydown', function(event) {
    var k = event.key
    // log(event)
    if (k == 'a') {
      leftDown = true
    } else if (k == 'd') {
      rightDown = true
    }
  })

  window.addEventListener('keyup', function(event) {
    var k = event.key
    // log(event)
    if (k == 'a') {
      leftDown = false
    } else if (k == 'd') {
      rightDown = false
    }
  })

  game.update = function() {
    // update x
    if (leftDown) {
      paddle.moveLeft()
    } else if (rightDown) {
      paddle.moveRight()
    }
  }
  game.draw = function() {
    game.context.drawImage(paddle.image, paddle.x, paddle.y)
  }
}
__main()
</script>
</body>

</html>